<!DOCTYPE html>
<html>
    <body>
        <h1>Client Certificate Authentication project</h1>
        <p>
            This project demonstrate how to setup client authentication with certificate.
            There is two locations :
            <ul>
                <li><a href="public/">public</a> : no authentication required, you can download the demo user certificate from there</li>
                <li><a href="private/">private</a> : you need to install the demo user certificate on your browser/operating system to access here</li>
            </ul>
            To install the client certificate, you'll need the password : password.
        </p>
        <h2>Current Status</h2>
        <p>
            <!--#if expr="-n %{SSL_CLIENT_S_DN_CN}" -->
                You are currently authenticated as <strong><!--#echo var="SSL_CLIENT_S_DN_CN" --></strong>.
            <!--#else -->
                You are currently not authenticated. Install <a href="public/user-certificate.p12">the demo user certificate</a> and reload this page.
            <!--#endif -->
        </p>
        <h2>SSL Environment Variables</h2>
        <p>
            <!--#echo var="DATE_LOCAL" -->
            <table>
                <tr><td>HTTPS</td><td>flag</td><td>HTTPS is being used.</td><td><!--#echo var="HTTPS" --></td></tr>
                <tr><td>SSL_PROTOCOL</td><td>string</td><td>The SSL protocol version (SSLv3, TLSv1, TLSv1.1, TLSv1.2)</td><td><!--#echo var="SSL_PROTOCOL" --></td></tr>
                <tr><td>SSL_SESSION_ID</td><td>string</td><td>The hex-encoded SSL session id</td><td><!--#echo var="SSL_SESSION_ID" --></td></tr>
                <tr><td>SSL_SESSION_RESUMED</td><td>string</td><td>Initial or Resumed SSL Session. Note: multiple requests may be served over the same (Initial or Resumed) SSL session if HTTP KeepAlive is in use</td><td><!--#echo var="SSL_SESSION_RESUMED" --></td></tr>
                <tr><td>SSL_SECURE_RENEG</td><td>string</td><td>true if secure renegotiation is supported, else false</td><td><!--#echo var="SSL_SECURE_RENEG" --></td></tr>
                <tr><td>SSL_CIPHER</td><td>string</td><td>The cipher specification name</td><td><!--#echo var="SSL_CIPHER" --></td></tr>
                <tr><td>SSL_CIPHER_EXPORT</td><td>string</td><td>true if cipher is an export cipher</td><td><!--#echo var="SSL_CIPHER_EXPORT" --></td></tr>
                <tr><td>SSL_CIPHER_USEKEYSIZE</td><td>number</td><td>Number of cipher bits (actually used)</td><td><!--#echo var="SSL_CIPHER_USEKEYSIZE" --></td></tr>
                <tr><td>SSL_CIPHER_ALGKEYSIZE</td><td>number</td><td>Number of cipher bits (possible)</td><td><!--#echo var="SSL_CIPHER_ALGKEYSIZE" --></td></tr>
                <tr><td>SSL_COMPRESS_METHOD</td><td>string</td><td>SSL compression method negotiated</td><td><!--#echo var="SSL_COMPRESS_METHOD" --></td></tr>
                <tr><td>SSL_VERSION_INTERFACE</td><td>string</td><td>The mod_ssl program version</td><td><!--#echo var="SSL_VERSION_INTERFACE" --></td></tr>
                <tr><td>SSL_VERSION_LIBRARY</td><td>string</td><td>The OpenSSL program version</td><td><!--#echo var="SSL_VERSION_LIBRARY" --></td></tr>
                <tr><td>SSL_CLIENT_M_VERSION</td><td>string</td><td>The version of the client certificate</td><td><!--#echo var="SSL_CLIENT_M_VERSION" --></td></tr>
                <tr><td>SSL_CLIENT_M_SERIAL</td><td>string</td><td>The serial of the client certificate</td><td><!--#echo var="SSL_CLIENT_M_SERIAL" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN</td><td>string</td><td>Subject DN in client's certificate</td><td><!--#echo var="SSL_CLIENT_S_DN" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_C</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_C" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_ST</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_ST" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_L</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_L" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_O</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_O" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_OU</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_OU" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_CN</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_CN" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_T</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_T" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_I</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_I" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_G</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_G" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_S</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_S" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_D</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_D" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_UID</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_UID" --></td></tr>
                <tr><td>SSL_CLIENT_S_DN_Email</td><td>string</td><td>Component of client's Subject DN</td><td><!--#echo var="SSL_CLIENT_S_DN_Email" --></td></tr>
                <tr><td>SSL_CLIENT_SAN_Email_0</td><td>string</td><td>Client certificate's subjectAltName extension entries of type rfc822Name</td><td><!--#echo var="SSL_CLIENT_SAN_Email_0" --></td></tr>
                <tr><td>SSL_CLIENT_SAN_DNS_0</td><td>string</td><td>Client certificate's subjectAltName extension entries of type dNSName</td><td><!--#echo var="SSL_CLIENT_SAN_DNS_0" --></td></tr>
                <tr><td>SSL_CLIENT_SAN_OTHER_msUPN_0</td><td>string</td><td>Client certificate's subjectAltName extension entries of type otherName, Microsoft User Principal Name form (OID 1.3.6.1.4.1.311.20.2.3)</td><td><!--#echo var="SSL_CLIENT_SAN_OTHER_msUPN_0" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN</td><td>string</td><td>Issuer DN of client's certificate</td><td><!--#echo var="SSL_CLIENT_I_DN" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_C</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_C" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_ST</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_ST" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_L</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_L" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_O</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_O" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_OU</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_OU" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_CN</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_CN" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_T</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_T" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_I</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_I" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_G</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_G" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_S</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_S" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_D</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_D" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_UID</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_UID" --></td></tr>
                <tr><td>SSL_CLIENT_I_DN_Email</td><td>string</td><td>Component of client's Issuer DN</td><td><!--#echo var="SSL_CLIENT_I_DN_Email" --></td></tr>
                <tr><td>SSL_CLIENT_V_START</td><td>string</td><td>Validity of client's certificate (start time)</td><td><!--#echo var="SSL_CLIENT_V_START" --></td></tr>
                <tr><td>SSL_CLIENT_V_END</td><td>string</td><td>Validity of client's certificate (end time)</td><td><!--#echo var="SSL_CLIENT_V_END" --></td></tr>
                <tr><td>SSL_CLIENT_V_REMAIN</td><td>string</td><td>Number of days until client's certificate expires</td><td><!--#echo var="SSL_CLIENT_V_REMAIN" --></td></tr>
                <tr><td>SSL_CLIENT_A_SIG</td><td>string</td><td>Algorithm used for the signature of client's certificate</td><td><!--#echo var="SSL_CLIENT_A_SIG" --></td></tr>
                <tr><td>SSL_CLIENT_A_KEY</td><td>string</td><td>Algorithm used for the public key of client's certificate</td><td><!--#echo var="SSL_CLIENT_A_KEY" --></td></tr>
                <tr><td>SSL_CLIENT_CERT</td><td>string</td><td>PEM-encoded client certificate</td><td><!--#echo var="SSL_CLIENT_CERT" --></td></tr>
                <tr><td>SSL_CLIENT_CERT_CHAIN_0</td><td>string</td><td>PEM-encoded certificates in client certificate chain</td><td><!--#echo var="SSL_CLIENT_CERT_CHAIN_0" --></td></tr>
                <tr><td>SSL_CLIENT_CERT_RFC4523_CEA</td><td>string</td><td>Serial number and issuer of the certificate. The format matches that of the CertificateExactAssertion in RFC4523</td><td><!--#echo var="SSL_CLIENT_CERT_RFC4523_CEA" --></td></tr>
                <tr><td>SSL_CLIENT_VERIFY</td><td>string</td><td>NONE, SUCCESS, GENEROUS or FAILED:reason</td><td><!--#echo var="SSL_CLIENT_VERIFY" --></td></tr>
                <tr><td>SSL_SERVER_M_VERSION</td><td>string</td><td>The version of the server certificate</td><td><!--#echo var="SSL_SERVER_M_VERSION" --></td></tr>
                <tr><td>SSL_SERVER_M_SERIAL</td><td>string</td><td>The serial of the server certificate</td><td><!--#echo var="SSL_SERVER_M_SERIAL" --></td></tr>
                <tr><td>SSL_SERVER_S_DN</td><td>string</td><td>Subject DN in server's certificate</td><td><!--#echo var="SSL_SERVER_S_DN" --></td></tr>
                <tr><td>SSL_SERVER_SAN_Email_0</td><td>string</td><td>Server certificate's subjectAltName extension entries of type rfc822Name</td><td><!--#echo var="SSL_SERVER_SAN_Email_0" --></td></tr>
                <tr><td>SSL_SERVER_SAN_DNS_0</td><td>string</td><td>Server certificate's subjectAltName extension entries of type dNSName</td><td><!--#echo var="SSL_SERVER_SAN_DNS_0" --></td></tr>
                <tr><td>SSL_SERVER_SAN_OTHER_dnsSRV_0</td><td>string</td><td>Server certificate's subjectAltName extension entries of type otherName, SRVName form (OID 1.3.6.1.5.5.7.8.7, RFC 4985)</td><td><!--#echo var="SSL_SERVER_SAN_OTHER_dnsSRV_0" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_C</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_C" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_ST</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_ST" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_L</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_L" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_O</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_O" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_OU</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_OU" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_CN</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_CN" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_T</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_T" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_I</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_I" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_G</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_G" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_S</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_S" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_D</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_D" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_UID</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_UID" --></td></tr>
                <tr><td>SSL_SERVER_S_DN_Email</td><td>string</td><td>Component of server's Subject DN</td><td><!--#echo var="SSL_SERVER_S_DN_Email" --></td></tr>
                <tr><td>SSL_SERVER_I_DN</td><td>string</td><td>Issuer DN of server's certificate</td><td><!--#echo var="SSL_SERVER_I_DN" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_C</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_C" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_ST</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_ST" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_L</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_L" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_O</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_O" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_OU</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_OU" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_CN</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_CN" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_T</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_T" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_I</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_I" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_G</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_G" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_S</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_S" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_D</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_D" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_UID</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_UID" --></td></tr>
                <tr><td>SSL_SERVER_I_DN_Email</td><td>string</td><td>Component of server's Issuer DN</td><td><!--#echo var="SSL_SERVER_I_DN_Email" --></td></tr>
                <tr><td>SSL_SERVER_V_START</td><td>string</td><td>Validity of server's certificate (start time)</td><td><!--#echo var="SSL_SERVER_V_START" --></td></tr>
                <tr><td>SSL_SERVER_V_END</td><td>string</td><td>Validity of server's certificate (end time)</td><td><!--#echo var="SSL_SERVER_V_END" --></td></tr>
                <tr><td>SSL_SERVER_A_SIG</td><td>string</td><td>Algorithm used for the signature of server's certificate</td><td><!--#echo var="SSL_SERVER_A_SIG" --></td></tr>
                <tr><td>SSL_SERVER_A_KEY</td><td>string</td><td>Algorithm used for the public key of server's certificate</td><td><!--#echo var="SSL_SERVER_A_KEY" --></td></tr>
                <tr><td>SSL_SERVER_CERT</td><td>string</td><td>PEM-encoded server certificate</td><td><!--#echo var="SSL_SERVER_CERT" --></td></tr>
                <tr><td>SSL_SRP_USER</td><td>string</td><td>SRP username</td><td><!--#echo var="SSL_SRP_USER" --></td></tr>
                <tr><td>SSL_SRP_USERINFO</td><td>string</td><td>SRP user info</td><td><!--#echo var="SSL_SRP_USERINFO" --></td></tr>
                <tr><td>SSL_TLS_SNI</td><td>string</td><td>Contents of the SNI TLS extension (if supplied with ClientHello)</td><td><!--#echo var="SSL_TLS_SNI" --></td></tr>
            </table>
        </p>
    </body>
</html>